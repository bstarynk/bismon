% file bismon-doc.tex
\documentclass[11pt,a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8x]{inputenc}
\usepackage{alltt}
\usepackage{moreverb}
\usepackage{fancyvrb}
\usepackage{fancyhdr}
\usepackage{epsfig}
\usepackage{makeidx}
\usepackage{float}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{moreverb}
\usepackage{multirow}
\usepackage{boxedminipage}
\usepackage[square]{natbib}
\usepackage{charter}
\usepackage{hevea}
\usepackage{listings}
\usepackage{relsize}
\usepackage{verbatimbox}
\usepackage{filecontents}
\usepackage{catchfile}
\usepackage{lastpage}
\usepackage[a4paper, margin=2cm]{geometry}

\newcommand{\bmemail}[1]{{\href{mailto:#1}{\texttt{\textbf{#1}}}}}
\newcommand{\bmurl}[1]{{\href{#1}{\texttt{\textbf{#1}}}}}

%see https://tex.stackexchange.com/a/51656/42406
\lstdefinelanguage
   [x64]{Assembler}     % add a "x64" dialect of Assembler
   [x86masm]{Assembler} % based on the "x86masm" dialect
   % with these extra keywords:
   {morekeywords={CDQE,CQO,CMPSQ,CMPXCHG16B,JRCXZ,LODSQ,MOVSXD, %
                  POPFQ,PUSHFQ,SCASQ,STOSQ,IRETQ,RDTSCP,SWAPGS, %
                  rax,rdx,rcx,rbx,rsi,rdi,rsp,rbp, %
                  r8,r8d,r8w,r8b,r9,r9d,r9w,r9b, %
                  r10,r10d,r10w,r10b,r11,r11d,r11w,r11b, %
                  r12,r12d,r12w,r12b,r13,r13d,r13w,r13b, %
                  r14,r14d,r14w,r14b,r15,r15d,r15w,r15b}} % etc.

%% https://latex.org/forum/viewtopic.php?t=3970
%\makeatletter
%\newcommand*\bmexpandableinput[1]{\@@input#1 }
%\makeatother

% generated files
\input{generated/git-commit.tex}
\input{generated/timestamp.tex}


% LaTeX specific macros that HeVeA should ignore
\input{bismon-latex.tex}

\date{\bmdocdate}

%-\title{{\color{orange}{D1.3v1}}~Specialized Static Analysis tools for more secure and safer IoT software development.
%-  \\
%-  {\large{\emph{Bismon}~\thanks{The \texttt{bismon} name is temporary and
%-    is likely to change later. See also the
%-    \bmurl{http://github.com/bstarynk/bismon} repository; this documentation was generated with its \texttt{build-bismon-doc.sh} script}~ documentation}}}
%-
%-\author{Basile \textsc{Starynkevitch}\thanks{Email
%-    \bmemail{basile@starynkevitch.net} or
%-    \bmemail{basile.starynkevitch@cea.fr}}, %
%-  \\ {\small{CEA, LIST,
%-      France}}}
%-
\makeindex

\begin{document}

\bibliographystyle{abbrvnat}


\pagestyle{fancy}
\fancyhf{}
\rhead{\textsc{Chariot} D1.3~\textsuperscript{v1}}
\lhead{Specialized Static Analysis tools for IoT \ldots - \emph{Bismon}}
\renewcommand{\footrulewidth}{0.4pt}
% https://tex.stackexchange.com/a/317531/42406
\futurelet\TMPfootrule\def\footrule{{\color{orange}\TMPfootrule}}
\futurelet\TMPheadrule\def\headrule{{\color{orange}\TMPheadrule}}
\rfoot{Page \thepage ~ {\relsize{-2.5}{of \pageref{LastPage}}}}
\begin{titlepage}
%\maketitle

  \thispagestyle{empty}

  \begin{center}
    
    %   \bmincludewidthgraphics{width=194pt}{CHARIOT-logo-fig}{eps}{eps}
    \includegraphics[width=194pt]{images/CHARIOT-logo}

    {\large \textbf{C}ognitive \textbf{H}eterogeneous  \textbf{Ar}chitecture for
Industrial~\textbf{IoT}}
    
    {\color{orange}\Huge {D1.3~\textsuperscript{v1}~Specialized Static Analysis tools for more secure and safer IoT software development.}\\
    {\Large \emph{Bismon} documentation.}}

  
\begin{relsize}{-0.1}
\subsection*{Document Summary Information}
  \begin{tabular}{|l|l|l|l|}
    \hline 
  \textbf{Grant Agreement} & 780075 & \textbf{Acronym} & \textsc{Chariot} \\
  \hline 
    {\textbf{Full title}} & %
    \multicolumn{3}{l|}{\textbf{\relsize{+0.5}{C}}ognitive \textbf{\relsize{+0.5}{H}}eterogeneous \textbf{\relsize{+0.5}{A}}rchitecture for Industrial {\relsize{+0.5}{\textbf{IoT}}}}  \\
    \hline
    \textbf{Start date} & 01/01/2018 & \textbf{Duration} & 36 months \\
    \hline
  \textbf{Project URL} & \multicolumn{3}{l|}{{\large \href{http://www.chariotproject.eu}{\textbf{\texttt{www.chariotproject.eu}}}}} \\
    \hline
  \textbf{Deliverable} & \multicolumn{3}{p{9cm}|}{{\textbf{D1.3} Specialized Static Analysis tools for more secure and safer IoT software development.}} \\
    \hline
  \textbf{Workpackage} & \multicolumn{3}{l|}{\textbf{WP1}} \\
    \hline
  \textbf{Contractual due date} & {31/06/2020} (M30) & \textbf{Actual submission date} & - \\
    \hline
  \textbf{Nature} & R {\small (report)} & \textbf{dissemination level} & PU  {\small (public)} \\
    \hline
 \textbf{Lead beneficiary} & \multicolumn{3}{l|}{CEA, LIST} \\
 \hline
  \textbf{Responsible author} & \multicolumn{3}{l|}{Basile \textsc{Starynkevitch} (CEA, LIST)} \\
  \hline
  \textbf{Contributions from} &\multicolumn{3}{l|}{ - }
  \\
    \hline
  \textbf{Revision} &\multicolumn{3}{p{9cm}|}{git commit \texttt{\bmgitcommit}} \\
    \hline 
  {\emph{{\LaTeX}-generated}} &\multicolumn{3}{p{9cm}|}{{\scriptsize\textit{\bmdoctimestamp}}} \\
    \hline
\end{tabular}
\end{relsize}

\bigskip

\vspace{3cm}

\bigskip

 \begin{tabular}{c l}
   \hline
       \raisebox{-0.3cm}{{\bmincludewidthgraphics{0.08\textwidth}{Flag-of-Europe-fig}{eps}{svg}}}
       &
       \begin{minipage}{0.7\textwidth}\smallskip
         \begin{relsize}{-0.2}
           This \textsc{Chariot} project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Grant Agreement No 780075.
         \end{relsize}\\
         \end{minipage}
       \\
   \hline
 \end{tabular}

  \end{center}

  \newpage


  \subsection*{Revision history (including peer reviewing \& quality control)}
  
  \begin{tabular}{|p{0.1\textwidth}|p{0.1\textwidth}|p{0.1\textwidth}|l|l|}
    \hline
    \textbf{Version} & \textbf{Issue date} & \textbf{\% Complete} & \textbf{Changes} & \textbf{Contributor(s)} \\
    \hline
    \multicolumn{5}{|c|}{\parbox[c][1cm][c]{0.5\textwidth}{\Large \textbf{\emph{Not Applicable}}} - see explanation below} \\
    \hline
  \end{tabular}

  \medskip
  
  {\large {\color{red}{@@For CHARIOT consortium: I (Basile Starynkevitch) could give a few \texttt{git commit}-s but not all of them. If you require them to be listed, then which \emph{precise}
        \texttt{git commit}-s could be considered as having been
        peer-reviewed and quality-controlled? Please list them
        extensively and send an email to me, \href{mailto:basile.starynkevitch@cea.fr}{\texttt{basile.starynkevitch@cea.fr}}. Thanks!}}}

  \medskip
  
This partly generated document and the \emph{Bismon} software itself
are co-developed in an agile and incremental manner, and have exactly {\bmgitnumbercommits} \href{http://git-scm.com/}{\texttt{git}}
commits on \textit{\bmdoctimestamp}. See
\bmurl{https://github.com/bstarynk/bismon/commits/} for details. These commits are too numerous and too fine grained to be considered as ``versions''. Given the agile and continuous workflow, it is unreasonable, and practically impossible, to identify any formalized versions.

\begin{relsize}{-0.5}
This document is co-developed with the \emph{Bismon} software itself,
it is typeset using \LaTeX~on Linux and contains some \emph{generated}
documentation~\footnote{The generated parts are clearly identified as
  such, and are extracted from the \emph{Bismon} system.}, mixed with
hand-written text. During development of \texttt{bismon}, the amount
of generated documentation will grow.  The entire history of
\emph{Bismon} (both the software -including its persistent store- and
this document) is available on
\bmurl{https://github.com/bstarynk/bismon/commits} and has, for this
document of commit id \texttt{\bmgitcommit} generated on
\textit{\bmdocdate}, exactly {\bmgitnumbercommits} commits (or
elementary changes). Since changes on any file in the \texttt{git}
repository can affect this document, no ``version'' is identifiable.
\end{relsize}
\bigskip

For convenience to the reader, here are the last~\footnote{Obtained by the
  \texttt{git log --name-status -4} command running in \emph{bismon}
  top source directory.} four \texttt{git commit}-s:

\begin{relsize}{-2}
  \input{generated/000-lastgitcommits.tex}
\end{relsize}

There is no notion of any identifiable ``version'' in \emph{bismon}, so
also in this D1.3~\textsuperscript{v1} deliverable. The work is incremental and the
development is agile.

\bigskip

\subsection*{disclaimer}

\begin{center}
  \fbox{\parbox{0.92\textwidth}{ \small The content of the publication
      herein is the sole responsibility of the publishers and it does
      not necessarily represent the views expressed by the European
      Commission or its services.

      While the information contained in
      the documents is believed to be accurate, the authors(s) or any
      other participant in the \textsc{Chariot} consortium make no
      warranty of any kind with regard to this material including, but
      not limited to the implied warranties of merchantability and
      fitness for a particular purpose.

      Neither the \textsc{Chariot}
      Consortium nor any of its members, their officers, employees or
      agents shall be responsible or liable in negligence or otherwise
      howsoever in respect of any inaccuracy or omission herein.
      
      Without derogating from the generality of the foregoing neither
      the \textsc{Chariot} Consortium nor any of its members, their
      officers, employees or agents shall be liable for any direct or
      indirect or consequential loss or damage caused by or arising
      from any information advice or inaccuracy or omission herein.  }
  }
\end{center}

\smallskip

  \fbox{\parbox{0.92\textwidth}{ 
This deliverable contains original unpublished work except where
clearly indicated otherwise. Acknowledgement of previously published
material and of the work of others has been made through appropriate
citation, quotation or both.}}



  \subsection*{Executive Summary}
This D1.3\textsuperscript{v1} \textsc{Chariot} deliverable is a first \textbf{draft}
-and \emph{preliminary}- version of D1.3\textsuperscript{v2} scheduled at M30 on
``Specialized Static Analysis tools for more secure and safer IoT
software development''.

It describes the \textsc{Chariot} vision on static source code (mostly
of C and C++ code for IoT firmware and application) analysis. It
proposes a \emph{simple} static analysis \emph{framework} leveraging
on the powerful recent \emph{GCC} [cross-]compiler. A \emph{persistent
  monitor} (tentatively named \texttt{bismon}) is being designed and
implemented as a GPLv3+ free software for Linux, using
meta-programming techniques (leveraging on experience gained in the
former GCC MELT project) to \emph{generate} GCC plugins, and able to
keep some intermediate results (of compilation or static analysis)
during the entire life of the IoT project, and giving to the IoT
developers (thru a web interface) a whole-program view of the source
code (as digested by the \emph{GCC} cross-compiler) and of its static
analysis properties. That framework is configurable and scriptable by
static analysis experts, hence permitting different IoT projects to
address various concerns, while keeping the usual IoT development
workflow (running as usual their \emph{GCC} cross-compiler on Linux,
with extra plugin-related compilation flags).


\subsection*{notice}

\begin{quote}
\begin{relsize}{-2}
\footnotesize This work is funded (from start of 2018 to end of
2020) thru the \emph{\textsc{Chariot}} project (see \bmurl{http://chariotproject.eu/})
which has received funding from the European Union’s Horizon 2020
research and innovation programme under the Grant Agreement No
780075.
\end{relsize}
\end{quote}
\medskip



\hspace{2cm}

\begin{center}
%{\small git commit: \texttt{\bmgitcommit}}
%
%{\small generated: \textit{\bmdoctimestamp}}
%
%\hspace{1cm}

\begin{tabular}{cc}
  \bmincludewidthgraphics{72pt}{CHARIOT-logo-img}{png}{png} %
  & \bmincludewidthgraphics{64pt}{Flag-of-Europe-fig}{eps}{svg}
\end{tabular}


\hspace{1cm}

\hrule

\bigskip

\textbf{Deliverable created during the \href{http://chariotproject.eu/}{\textsc{Chariot}} project.}
\end{center}
\end{titlepage}





\newpage

\tableofcontents

\newpage
\listoffigures

\medskip

\listoftables

\newpage

\rfoot{Page \thepage ~ {\relsize{-2}{of \pageref{LastPage}}}}
\newpage


\subsection*{Glossary of terms and abbreviations used}

\smallskip

\begin{tabular}{|c|p{0.7\textwidth}|}
  \hline
  \begin{minipage}{0.15\textwidth}

    \smallskip
    
    \textbf{Abbreviation / Term}

    \smallskip
    
  \end{minipage} & \textbf{Description} \\
  \hline \emph{binutils} & GNU free software package containing assembler \texttt{as}, linker \texttt{ld} and other utilities to operate on object files or binary executables, etc... \bmurl{https://www.gnu.org/software/binutils/} \\
  \hline \texttt{bismon} & the free software framework and persistent monitor described here ; source repository on \bmurl{http://github.com/bstarynk/bismon/} \\
  \hline Frama-C &  a free sofware extensible platform for analysis of C software \bmurl{http://frama-c.com/} \\
  \hline FSF & Free Software Foundation \bmurl{http://fsf.org/} \\
  \hline GCC & Gnu Compiler Collection \bmurl{http://gcc.gnu.org/} \\
  \hline GCC MELT & was a (GPLv3+-licensed) GCC plugin and framework providing a DSL to ease GCC extensions ; it is archived on \bmurl{http://starynkevitch.net/Basile/gcc-melt/}\\
  \hline Generic & language-independent abstract syntax tree in GCC \\
  \hline Gimple & middle-end internal representation in GCC \\
  \hline GPL & Gnu General Public Licence (a copylefted free software license) \bmurl{https://www.gnu.org/licenses/gpl.html} \\
  \hline IoT & Internet of Things \\
  \hline \texttt{libonion} & an HTTP server library \bmurl{https://www.coralbits.com/libonion/} \\
  \hline MELT & the Lisp-like domain specific language used in GCC MELT \\
  \hline SSA & Static Single Assignment (in GCC, a variant of Gimple) \\
  \hline
\end{tabular}

\newpage
\input{intro-bm}

\newpage

\input{datapersist-bm}

\newpage

\input{staticanalys-bm}

\newpage
\input{using-bm}

\newpage
\input{miscwork-bm}

\newpage
\input{conclus-bm}

\bibliography{bismon-biblio}

\begin{flushright}
  \begin{relsize}{-2}
    For books in French, I have provided a \emph{tentative} translation into
    English of their title in brackets.
  \end{relsize}
\end{flushright}

\clearpage

\printindex

\medskip

\begin{center}
\begin{boxedminipage}{0.9\textwidth}

To build this document (both in PDF and HTML forms) : build
\emph{bismon} \footnote{See the \emph{Readme} on
  \bmurl{https://github.com/bstarynk/bismon/} for building
  instructions} on your Linux workstatation, then run \texttt{make
  doc} (that uses {\LaTeX} and
\href{http://hevea.inria.fr/}{\emph{HeVeA}}).

Feedback and improvements on this document can be suggested by email
(to \bmemail{basile@starynkevitch.net} or
\bmemail{basile.starynkevitch@cea.fr}) or by submitting patches to
\textit{Bismon} thru its \bmurl{https://github.com/bstarynk/bismon} repository
(or by email). Notice that this document may contain generated
documentation, and will contain more and more generated parts in the
future.
\end{boxedminipage}
\end{center}

\bigskip

\hrule

\bigskip

The CC-BY-SA license below for this (\textsc{Chariot}
D1.3\textsuperscript{v1}) deliverable is required to enable major parts
of this report to be later incorporated into a proper
\emph{bismon} free software documentation. For example, the Debian
Linux distribution has a policy~\footnote{See Debian documentation
  project on \bmurl{https://www.debian.org/doc/ddp} etc...} strongly
recommending a specific set of licenses (notably CC-BY-SA) for
documentation. Using other (deemed proprietary) licenses in free
software documentation is decreasing the future chances of such
documentation being incorporated in potential Debian releases.

\begin{quote}
{\footnotesize \bmincludewidthgraphics{60pt}{CC-BY-SA-4-img}{png}{png} This document
is licensed under the Creative Commons Attribution-ShareAlike 4.0
International License. To view a copy of this license, visit
\bmurl{http://creativecommons.org/licenses/by-sa/4.0/} or send a letter to
Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.}
\end{quote}

\begin{flushright}
  \begin{relsize}{-1}
    git commit \texttt{\bmgitcommit}; generated on \textit{\bmdoctimestamp}
  \end{relsize}
\end{flushright}

\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Local Variables: ;;
%% compile-command: "cd ..; ./build-bismon-doc.sh" ;;
%% End: ;;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
